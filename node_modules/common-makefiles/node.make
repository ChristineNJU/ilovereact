###
# This File is part of the common-makefiles repository.
# <http://github.com/subtub/common-makefiles>
#
# Generated by the buil.sh script. DO NOT EDIT!
# Date: Do 14 Nov 2013 09:56:51 CET
###


# the parameter
# apidoc parameter

ifndef APIDOC_INPUT
	APIDOC_INPUT := routes/
endif

ifndef APIDOC_OUTPUT
	APIDOC_OUTPUT := docs/
endif

# jsdox parameter

ifndef JSDOX_INPUT
	JSDOX_INPUT := lib
endif

ifndef JSDOX_OUTPUT
	JSDOX_OUTPUT := docs
endif

ifndef JSDOX_FILENAME
	JSDOX_FILENAME := api.md
endif

JSDOX_DEFAULT_PATH=$(CURDIR)/$(JSDOX_OUTPUT)/index.md
JSDOX_CURRENT_PATH=$(CURDIR)/$(JSDOX_OUTPUT)/$(JSDOX_FILENAME)

# jshint parameter

ifndef HINT_DIR
	HINT_DIR := lib/
endif

# mocha parameter

ifndef MOCHA_REPORTER
	MOCHA_REPORTER := spec
endif

ifndef MOCHA_TIMEOUT
	MOCHA_TIMEOUT := 2000
endif

ifndef MOCHA_SLOW
	MOCHA_SLOW := 75
endif

# plato parameter

ifndef PLATO_TITLE
	PLATO_TITLE := $(shell basename $(PWD))
endif

ifndef PLATO_OUTPUT_DIR
	PLATO_OUTPUT_DIR := report
endif

ifndef PLATO_FILES
	PLATO_FILES := lib/
endif


# the tasks
# apidoc targets

apidoc:
	@node node_modules/.bin/apidoc --input $(APIDOC_INPUT) --output $(APIDOC_OUTPUT)

apidoc-help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  apidoc                  Build the api docs"
	@echo "  apidoc-help             output usage information"
	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

.PHONY: apidoc apidoc-help

# jsdox targets

jsdox-extra:
	@rm -rf $(JSDOX_CURRENT_PATH)
	@echo "## API\n \
	" > $(JSDOX_CURRENT_PATH)
	@node node_modules/.bin/jsdox --output $(JSDOX_OUTPUT) $(JSDOX_INPUT)
	@cat $(JSDOX_DEFAULT_PATH) >> $(JSDOX_CURRENT_PATH)
	@rm $(JSDOX_DEFAULT_PATH)
	@echo "jsdox Finished"

jsdox:
	@node node_modules/.bin/jsdox --output $(JSDOX_OUTPUT) $(JSDOX_INPUT)

jsdox-help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  jsdox                  build the docs"
	@echo "  jsdox-help             output usage information"
	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

.PHONY: jsdox jsdox-help

# jshint targets

jshint:
	@node node_modules/.bin/jshint $(HINT_DIR)
	@echo "Hinting Finished"

jshint-help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  jshint                 hint some files"
	@echo "  jshint-help            output usage information"
	@echo "  jshint-version         output the version number"

	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

jshint-version:
	@node node_modules/.bin/jshint --version

.PHONY: jshint jshint-help jshint-version

# mocha targets

mocha:
	@node node_modules/.bin/mocha --timeout $(MOCHA_TIMEOUT) --slow $(MOCHA_SLOW) --reporter $(MOCHA_REPORTER)
	@echo "Mocha Test Finished!"

mocha-help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  mocha                  run the tests with mocha"
	@echo "  mocha-help             output usage information"
	@echo "  mocha-version          output the version number"
	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

mocha-version:
	@node node_modules/.bin/mocha --version

.PHONY: mocha mocha-help mocha-version

# plato targets

plato:
	@node node_modules/.bin/plato --title $(PLATO_TITLE) --recurse --dir $(PLATO_OUTPUT_DIR) $(PLATO_FILES)

plato-gh-pages:
	@git checkout gh-pages
	@cp -rf $(PLATO_OUTPUT_DIR) ../$(PLATO_OUTPUT_DIR)
	@git checkout master
	@mv ../$(PLATO_OUTPUT_DIR) $(PLATO_OUTPUT_DIR)
	$(MAKE) plato
	@mv $(PLATO_OUTPUT_DIR) ../$(PLATO_OUTPUT_DIR)
	@git checkout gh-pages
	@rm -rf $(PLATO_OUTPUT_DIR)
	@mv ../$(PLATO_OUTPUT_DIR) $(PLATO_OUTPUT_DIR)
	@git add report/
	@git commit -m "Report updated by CommonMakefiles"
	@git push
	@git checkout master

plato-help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  plato                  run the report generator"
	@echo "  plato-gh-pages         make plato and push to gh-pages branch"
	@echo "  plato-help             output usage information"
	@echo "  plato-version          output the version number"
	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

plato-version:
	@node node_modules/.bin/plato --version

.PHONY: plato plato-gh-pages plato-help plato-version


help:
	@echo ""
	@echo "common-makefiles v0.3.0"
	@echo ""
	@echo "Usage:"
	@echo ""
	@echo "  apidoc                  Build the api docs"
	@echo "  apidoc-help             output usage information"
	@echo "  jsdox                  build the docs"
	@echo "  jsdox-help             output usage information"
	@echo "  jshint                 hint some files"
	@echo "  jshint-help            output usage information"
	@echo "  jshint-version         output the version number"

	@echo "  mocha                  run the tests with mocha"
	@echo "  mocha-help             output usage information"
	@echo "  mocha-version          output the version number"
	@echo "  plato                  run the report generator"
	@echo "  plato-gh-pages         make plato and push to gh-pages branch"
	@echo "  plato-help             output usage information"
	@echo "  plato-version          output the version number"
	@echo ""
	@echo "Report bugs to <https://github.com/subtub/common-makefiles/issues>"
	@echo ""

.PHONY: help
